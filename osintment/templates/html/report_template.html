<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ report_title }} - OSINT Intelligence Report</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            line-height: 1.6;
            color: #1a1a1a;
            background: #f8f9fa;
        }

        .page {
            background: white;
            max-width: 1200px;
            margin: 0 auto;
            box-shadow: 0 0 30px rgba(0,0,0,0.1);
        }

        /* Cover Page */
        .cover-page {
            min-height: 100vh;
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
            color: white;
            padding: 80px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            page-break-after: always;
        }

        .cover-logo {
            width: 120px;
            margin-bottom: 60px;
        }

        .cover-title {
            font-size: 48px;
            font-weight: 700;
            margin-bottom: 20px;
            letter-spacing: -1px;
        }

        .cover-subtitle {
            font-size: 24px;
            font-weight: 300;
            margin-bottom: 60px;
            opacity: 0.9;
        }

        .cover-meta {
            border-top: 2px solid rgba(255,255,255,0.3);
            padding-top: 40px;
            margin-top: 100px;
        }

        .cover-meta-item {
            margin-bottom: 15px;
            font-size: 16px;
        }

        .cover-meta-label {
            font-weight: 600;
            margin-right: 10px;
        }

        .cover-confidential {
            margin-top: 60px;
            padding: 20px;
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
            text-align: center;
            font-weight: 600;
        }

        /* Content Pages */
        .content-page {
            padding: 60px 80px;
            page-break-after: always;
        }

        .header {
            border-bottom: 3px solid #1e3a8a;
            padding-bottom: 20px;
            margin-bottom: 40px;
        }

        h1 {
            color: #1e3a8a;
            font-size: 36px;
            font-weight: 700;
            margin-bottom: 10px;
        }

        h2 {
            color: #1e3a8a;
            font-size: 28px;
            font-weight: 600;
            margin-top: 40px;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e5e7eb;
        }

        h3 {
            color: #374151;
            font-size: 20px;
            font-weight: 600;
            margin-top: 30px;
            margin-bottom: 15px;
        }

        /* Executive Summary */
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .summary-card {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            padding: 30px;
            border-radius: 12px;
            border-left: 4px solid #3b82f6;
        }

        .summary-card-value {
            font-size: 42px;
            font-weight: 700;
            color: #1e3a8a;
            margin-bottom: 10px;
        }

        .summary-card-label {
            font-size: 14px;
            color: #64748b;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Tables */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 25px 0;
            background: white;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            border-radius: 8px;
            overflow: hidden;
        }

        thead {
            background: #1e3a8a;
            color: white;
        }

        th {
            padding: 16px;
            text-align: left;
            font-weight: 600;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        td {
            padding: 14px 16px;
            border-bottom: 1px solid #e5e7eb;
            font-size: 14px;
        }

        tr:hover {
            background: #f9fafb;
        }

        tr:last-child td {
            border-bottom: none;
        }

        /* Alert Boxes */
        .alert {
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid;
        }

        .alert-critical {
            background: #fef2f2;
            border-color: #dc2626;
            color: #7f1d1d;
        }

        .alert-warning {
            background: #fffbeb;
            border-color: #f59e0b;
            color: #78350f;
        }

        .alert-info {
            background: #eff6ff;
            border-color: #3b82f6;
            color: #1e3a8a;
        }

        .alert-success {
            background: #f0fdf4;
            border-color: #10b981;
            color: #14532d;
        }

        .alert-title {
            font-weight: 700;
            font-size: 16px;
            margin-bottom: 8px;
        }

        /* Lists */
        ul, ol {
            margin: 15px 0;
            padding-left: 30px;
        }

        li {
            margin: 8px 0;
            line-height: 1.8;
        }

        /* Code/Data Display */
        .data-block {
            background: #f8f9fa;
            border: 1px solid #e5e7eb;
            border-radius: 6px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            overflow-x: auto;
            margin: 15px 0;
        }

        /* Badge */
        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            margin-right: 8px;
        }

        .badge-critical { background: #fee2e2; color: #dc2626; }
        .badge-high { background: #fed7aa; color: #ea580c; }
        .badge-medium { background: #fef3c7; color: #d97706; }
        .badge-low { background: #dbeafe; color: #2563eb; }
        .badge-info { background: #e0e7ff; color: #4f46e5; }

        /* Charts Container */
        .chart-container {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            margin: 25px 0;
        }

        /* Footer */
        .page-footer {
            margin-top: 60px;
            padding-top: 20px;
            border-top: 2px solid #e5e7eb;
            font-size: 12px;
            color: #6b7280;
            text-align: center;
        }

        /* Print Styles */
        @media print {
            .page { box-shadow: none; }
            .content-page { page-break-after: always; }
            .no-break { page-break-inside: avoid; }
        }

        /* Utility Classes */
        .text-center { text-align: center; }
        .text-muted { color: #6b7280; }
        .mb-2 { margin-bottom: 20px; }
        .mb-3 { margin-bottom: 30px; }
        .mt-2 { margin-top: 20px; }
        .mt-3 { margin-top: 30px; }
    </style>
</head>
<body>
    <div class="page">
        <!-- Cover Page -->
        <div class="cover-page">
            {% if logo_path %}
            <img src="{{ logo_path }}" alt="Company Logo" class="cover-logo">
            {% endif %}

            <div>
                <div class="cover-title">OSINT Intelligence Report</div>
                <div class="cover-subtitle">{{ report_title }}</div>

                <div class="cover-meta">
                    <div class="cover-meta-item">
                        <span class="cover-meta-label">Target:</span>
                        <span>{{ target }}</span>
                    </div>
                    <div class="cover-meta-item">
                        <span class="cover-meta-label">Scan Date:</span>
                        <span>{{ scan_date }}</span>
                    </div>
                    <div class="cover-meta-item">
                        <span class="cover-meta-label">Report Generated:</span>
                        <span>{{ report_date }}</span>
                    </div>
                    <div class="cover-meta-item">
                        <span class="cover-meta-label">Prepared By:</span>
                        <span>{{ author }}</span>
                    </div>
                    <div class="cover-meta-item">
                        <span class="cover-meta-label">Company:</span>
                        <span>{{ company_name }}</span>
                    </div>
                </div>

                <div class="cover-confidential">
                    CONFIDENTIAL - FOR AUTHORIZED USE ONLY
                </div>
            </div>
        </div>

        <!-- Executive Summary -->
        <div class="content-page">
            <div class="header">
                <h1>Executive Summary</h1>
            </div>

            <div class="summary-grid">
                <div class="summary-card">
                    <div class="summary-card-value">{{ summary.total_findings }}</div>
                    <div class="summary-card-label">Total Findings</div>
                </div>
                <div class="summary-card">
                    <div class="summary-card-value">{{ summary.unique_data_types }}</div>
                    <div class="summary-card-label">Data Types</div>
                </div>
                <div class="summary-card">
                    <div class="summary-card-value">{{ domain_intel.total_domains + domain_intel.total_subdomains }}</div>
                    <div class="summary-card-label">Domains Found</div>
                </div>
                <div class="summary-card">
                    <div class="summary-card-value">{{ domain_intel.total_ips }}</div>
                    <div class="summary-card-label">IP Addresses</div>
                </div>
            </div>

            <h2>Key Findings</h2>
            <p>This OSINT assessment was conducted on <strong>{{ target }}</strong> using automated intelligence gathering techniques. The analysis revealed {{ summary.total_findings }} distinct data points across {{ summary.unique_data_types }} different categories.</p>

            <h3>Top Discovery Categories</h3>
            <table>
                <thead>
                    <tr>
                        <th>Category</th>
                        <th>Findings</th>
                        <th>Percentage</th>
                    </tr>
                </thead>
                <tbody>
                    {% for category, count in summary.top_categories[:10] %}
                    <tr>
                        <td>{{ category }}</td>
                        <td>{{ count }}</td>
                        <td>{{ "%.1f" | format((count / summary.total_findings * 100)) }}%</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <!-- Critical Findings -->
        {% if critical_findings %}
        <div class="content-page">
            <div class="header">
                <h1>Critical Findings</h1>
            </div>

            <div class="alert alert-critical">
                <div class="alert-title">High Priority Items Detected</div>
                <p>The following findings require immediate attention and review.</p>
            </div>

            <table>
                <thead>
                    <tr>
                        <th>Type</th>
                        <th>Data</th>
                        <th>Source Module</th>
                        <th>Confidence</th>
                    </tr>
                </thead>
                <tbody>
                    {% for finding in critical_findings[:20] %}
                    <tr>
                        <td><span class="badge badge-critical">{{ finding.type }}</span></td>
                        <td>{{ finding.data }}</td>
                        <td>{{ finding.module }}</td>
                        <td>{{ finding.confidence }}%</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% endif %}

        <!-- Domain Intelligence -->
        <div class="content-page">
            <div class="header">
                <h1>Domain Intelligence</h1>
            </div>

            <h2>Primary Domains</h2>
            <table>
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Domain</th>
                    </tr>
                </thead>
                <tbody>
                    {% for domain in domain_intel.domains[:20] %}
                    <tr>
                        <td>{{ loop.index }}</td>
                        <td>{{ domain }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>

            <h2>Subdomains & Affiliates</h2>
            <table>
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Subdomain</th>
                    </tr>
                </thead>
                <tbody>
                    {% for subdomain in domain_intel.subdomains[:30] %}
                    <tr>
                        <td>{{ loop.index }}</td>
                        <td>{{ subdomain }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>

            <h2>IP Addresses</h2>
            <table>
                <thead>
                    <tr>
                        <th>#</th>
                        <th>IP Address</th>
                    </tr>
                </thead>
                <tbody>
                    {% for ip in domain_intel.ip_addresses[:30] %}
                    <tr>
                        <td>{{ loop.index }}</td>
                        <td>{{ ip }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <!-- Technology Stack -->
        {% if technology_stack %}
        <div class="content-page">
            <div class="header">
                <h1>Technology Stack Analysis</h1>
            </div>

            {% for category, items in technology_stack.items() %}
            {% if items %}
            <h2>{{ category }}</h2>
            <ul>
                {% for item in items %}
                <li>{{ item }}</li>
                {% endfor %}
            </ul>
            {% endif %}
            {% endfor %}
        </div>
        {% endif %}

        <!-- Contact Information -->
        {% if contacts.emails or contacts.phone_numbers or contacts.social_profiles %}
        <div class="content-page">
            <div class="header">
                <h1>Contact Information</h1>
            </div>

            {% if contacts.emails %}
            <h2>Email Addresses</h2>
            <table>
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Email</th>
                    </tr>
                </thead>
                <tbody>
                    {% for email in contacts.emails %}
                    <tr>
                        <td>{{ loop.index }}</td>
                        <td>{{ email }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            {% endif %}

            {% if contacts.phone_numbers %}
            <h2>Phone Numbers</h2>
            <table>
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Phone Number</th>
                    </tr>
                </thead>
                <tbody>
                    {% for phone in contacts.phone_numbers %}
                    <tr>
                        <td>{{ loop.index }}</td>
                        <td>{{ phone }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            {% endif %}

            {% if contacts.social_profiles %}
            <h2>Social Media Profiles</h2>
            <ul>
                {% for profile in contacts.social_profiles %}
                <li>{{ profile }}</li>
                {% endfor %}
            </ul>
            {% endif %}
        </div>
        {% endif %}

        <!-- Security Findings -->
        {% if security_findings.vulnerabilities or security_findings.malicious_indicators or security_findings.leaked_data %}
        <div class="content-page">
            <div class="header">
                <h1>Security Findings</h1>
            </div>

            <div class="alert alert-warning">
                <div class="alert-title">Security Assessment</div>
                <p>The following security-related items were identified during the scan.</p>
            </div>

            {% if security_findings.vulnerabilities %}
            <h2>Vulnerabilities</h2>
            <table>
                <thead>
                    <tr>
                        <th>Type</th>
                        <th>Details</th>
                        <th>Source</th>
                    </tr>
                </thead>
                <tbody>
                    {% for vuln in security_findings.vulnerabilities %}
                    <tr>
                        <td><span class="badge badge-critical">{{ vuln.type }}</span></td>
                        <td>{{ vuln.data }}</td>
                        <td>{{ vuln.module }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            {% endif %}

            {% if security_findings.malicious_indicators %}
            <h2>Malicious Indicators</h2>
            <table>
                <thead>
                    <tr>
                        <th>Type</th>
                        <th>Indicator</th>
                        <th>Source</th>
                    </tr>
                </thead>
                <tbody>
                    {% for indicator in security_findings.malicious_indicators %}
                    <tr>
                        <td><span class="badge badge-high">{{ indicator.type }}</span></td>
                        <td>{{ indicator.data }}</td>
                        <td>{{ indicator.module }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            {% endif %}

            {% if security_findings.leaked_data %}
            <h2>Leaked Data</h2>
            <table>
                <thead>
                    <tr>
                        <th>Type</th>
                        <th>Details</th>
                        <th>Source</th>
                    </tr>
                </thead>
                <tbody>
                    {% for leak in security_findings.leaked_data %}
                    <tr>
                        <td><span class="badge badge-critical">{{ leak.type }}</span></td>
                        <td>{{ leak.data }}</td>
                        <td>{{ leak.module }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            {% endif %}
        </div>
        {% endif %}

        <!-- Module Performance -->
        <div class="content-page">
            <div class="header">
                <h1>Module Performance Analysis</h1>
            </div>

            <p>Analysis of SpiderFoot module efficiency during the scan operation.</p>

            <table>
                <thead>
                    <tr>
                        <th>Rank</th>
                        <th>Module</th>
                        <th>Findings</th>
                        <th>Percentage</th>
                    </tr>
                </thead>
                <tbody>
                    {% for module in module_efficiency[:20] %}
                    <tr>
                        <td>{{ loop.index }}</td>
                        <td>{{ module.module }}</td>
                        <td>{{ module.findings }}</td>
                        <td>{{ "%.1f" | format((module.findings / summary.total_findings * 100)) }}%</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <!-- Appendix -->
        <div class="content-page">
            <div class="header">
                <h1>Appendix</h1>
            </div>

            <h2>Methodology</h2>
            <p>This OSINT assessment was conducted using SpiderFoot, an automated intelligence gathering platform. The scan employed multiple modules to collect publicly available information from various sources including DNS records, WHOIS data, search engines, social media platforms, and threat intelligence feeds.</p>

            <h2>Scope</h2>
            <ul>
                <li><strong>Target:</strong> {{ target }}</li>
                <li><strong>Scan Date:</strong> {{ scan_date }}</li>
                <li><strong>Modules Used:</strong> {{ summary.module_stats | length }}</li>
                <li><strong>Data Sources:</strong> Multiple public and commercial intelligence sources</li>
            </ul>

            <h2>Disclaimer</h2>
            <p>This report contains information gathered from publicly available sources. The accuracy of the data depends on the reliability of these sources. This assessment should be used as part of a comprehensive security evaluation and not as the sole basis for decision-making.</p>

            <div class="page-footer">
                <p><strong>{{ company_name }}</strong> | OSINT Intelligence Report | {{ report_date }}</p>
                <p>This document is confidential and intended solely for the use of the individual or entity to whom it is addressed.</p>
            </div>
        </div>
    </div>
</body>
</html>
